#!/bin/bash

clear
echo "______         _          _____"
echo "| ___ \       | |        /  ___|"
echo "| |_/ /_ _ ___| |_ __ _  \ \`--.  ___ _ ____   _____ _ __"
echo "|  __/ _\` / __| __/ _\` |  \`--. \/ _ \ '__\ \ / / _ \ '__|"
echo "| | | (_| \__ \ || (_| | /\__/ /  __/ |   \ V /  __/ |"
echo "\_|  \__,_|___/\__\__,_| \____/ \___|_|    \_/ \___|_|"
echo ""

bold=$(tput bold)
normal=$(tput sgr0)

if [ "$(id -u)" -eq 0 ]; then
  echo ""
  echo "${bold}--- DOCKER ---${normal}"
  echo ""
  echo "${bold}docker-clean${normal} [ROOT]"
  echo "  Prune all docker containers, images, volumes, networks ..."
  echo ""
  echo "${bold}docker-restart${normal} [ROOT]"
  echo "  In a directory containing a docker-compose.yaml file."
  echo "  Will down, then up detached, and hook logs."
  echo "  ctrl + c to close logs and keep containers running."
  echo ""
  echo "${bold}--- PROXY ---${normal}"
  echo ""
  echo "${bold}proxy-reload${normal} [ROOT]"
  echo "  Reload nginx config without restarting proxy."
  echo "  All pending connexions will stay alive."
  echo ""
  echo "${bold}proxy-restart${normal} [ROOT]"
  echo "  Restart nginx container."
  echo "  All pending connexions will be lost !"
  echo ""
  echo "${bold}proxy-password <branch> <domain?> <login:password?>${normal}"
  echo "  Set an http password for a domain."
  echo "  If no login and password pair is given, password will be removed."
  echo ""
fi
echo ""
echo "${bold}--- PROJECTS ---${normal}"
if [ "$(id -u)" -eq 0 ]; then
  echo ""
  echo "${bold}project-list${normal} [ROOT]"
  echo "  List all existing project workspaces."
  echo ""
  echo "${bold}project-create <project?>${normal} [ROOT]"
  echo "  Create a new project workspace."
  echo ""
  echo "${bold}project-archive <project?>${normal} [ROOT]"
  echo "  Archive a project and save data and keys to a tar.gz file."
  echo ""
  echo "${bold}project-show-key <project?>${normal} [ROOT]"
  echo "  Show the deploy key for a project"
  echo ""
  echo "${bold}project-revoke-key <project?>${normal} [ROOT]"
  echo "  Revoke access of current deploy key of a project and create a new deploy key."
fi
echo ""
echo "${bold}project-branch-clean <project?> <branch?>${normal}"
echo "  Clean all builds of a projects for a specific branch, and keep only the latest."
echo ""
echo "${bold}project-branch-remove <project?> <branch?>${normal}"
echo "  Stop running containers in this branch and remove build files."
echo "  Data files for this branch will be kept into data directory."
echo ""
echo ""
echo "${bold}--- FILE TRANSFER ---${normal}"
echo ""
echo "${bold}iterm-download <file>${normal}"
echo "  Download a file through iterm2 terminal."
echo "  Use rsync-download for big files."
echo ""
echo "${bold}rsync-download${normal} <file>"
echo "  Create an rsync command to download a file from your computer."
echo ""
echo "${bold}rsync-upload${normal} <file?>"
echo "  Create an rsync command to upload a file from your computer."
echo "  File override is disabled by default."
echo ""
echo ""
echo "${bold}--- TOOLS ---${normal}"
echo ""
echo "${bold}print-alias${normal}"
echo "  Show command to add this server to Pasta CLI"
if [ "$(id -u)" -eq 0 ]; then
  echo ""
  echo "${bold}lazydocker${normal} [ROOT]"
  echo "  Open docker management console"
  echo ""
  echo "${bold}htop${normal} [ROOT]"
  echo "  Open process manager"
  echo ""
  echo ""
  echo "${bold}--- UPGRADE ---${normal}"
  echo ""
  echo "${bold}pasta-upgrade${normal} [ROOT]"
  echo "  Update Pasta Server and optionally update Docker"
fi
